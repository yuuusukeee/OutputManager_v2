<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
<head>
  <meta charset="UTF-8">
  <title>アウトプット一覧</title>
  <link rel="stylesheet" th:href="@{/css/app.css(v=${#dates.createNow().time})}" />
</head>
<body>

<div class="container-narrow">

  <div class="nav-gap"></div>
  <h1>アウトプット一覧</h1>

  <!-- 検索バー（そのまま） -->
  <form method="get" th:action="@{/outputs}">
    <input type="text" name="keyword" th:value="${keyword}" placeholder="キーワードで検索">
    <select name="categoryId">
      <option th:value="-1" th:selected="${categoryId == -1}">お気に入り</option>
      <option th:value="__NULL__" th:selected="${categoryId == null}">すべて</option>
      <option th:each="c : ${categories}"
              th:value="${c.id}"
              th:selected="${categoryId != null and categoryId == c.id}"
              th:text="${c.name}">カテゴリ</option>
    </select>
    <button type="submit">検索</button>
  </form>

  <!-- 1) 最近のアウトプット -->
  <div class="section" th:if="${recent != null and !#lists.isEmpty(recent)}">
    <h2>最近のアウトプット</h2>
    <div class="h-scroll">
      <a class="out-card" th:each="o : ${recent}" th:href="@{|/outputs/${o.id}|}">
        <div class="out-title" th:text="${o.title}">タイトル</div>
        <div class="out-meta" th:text="${#temporals.format(o.createdAt, 'yyyy/MM/dd')}">2025/08/12</div>
        <div class="out-summary" th:text="${o.summary}">サマリ</div>
      </a>
    </div>
  </div>

  <!-- 2) お気に入り -->
  <div class="section" th:if="${favList != null and !#lists.isEmpty(favList)}">
    <h2>お気に入り</h2>
    <div class="h-scroll">
      <a class="out-card" th:each="o : ${favList}" th:href="@{|/outputs/${o.id}|}">
        <div class="out-title" th:text="${o.title}">タイトル</div>
        <div class="out-meta" th:text="${#temporals.format(o.createdAt, 'yyyy/MM/dd')}">2025/08/12</div>
        <div class="out-summary" th:text="${o.summary}">サマリ</div>
      </a>
    </div>
  </div>

  <!-- 3) カテゴリ別（学習 → 生活 → 仕事 → 健康 の順で表示） -->
  <th:block th:each="catId : ${categoryOrder}">
    <div class="section" th:if="${grouped[catId] != null and !#lists.isEmpty(grouped[catId])}">
      <h2 th:text="${categoryNameMap[catId]}">カテゴリ名</h2>
      <div class="h-scroll">
        <a class="out-card" th:each="o : ${grouped[catId]}" th:href="@{|/outputs/${o.id}|}">
          <div class="out-title" th:text="${o.title}">タイトル</div>
          <div class="out-meta" th:text="${#temporals.format(o.createdAt, 'yyyy/MM/dd')}">2025/08/12</div>
          <div class="out-summary" th:text="${o.summary}">サマリ</div>
        </a>
      </div>
    </div>
  </th:block>

</div>
</body>
</html>